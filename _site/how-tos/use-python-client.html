<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>How To Use the Python Client</title>
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <div class="container">
        <header>
            <a href="/"> 
                <img src="/img/logo.svg" alt="Molecula Logo" class="logo">
            </a>
        </header>
        <main class="container__main">
            <!-- Left sidebar -->
            <aside class="container__left">
                <ul>
    
      
        <li><a href="/index.html">Home</a></li>
        
  
      
    
       
        <li><p>Tutorials</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/tutorials/getting-started.html">Getting Started</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Explanation</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/explanations/architecture.html">Architecture</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>How-Tos</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/how-tos/install-featurebase.html">Install FeatureBase</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Reference</a></li>
        
  
      
        <ul>
    
       
        <li><p>Interfaces</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/reference/apis.html">APIs</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Query Languages</a></li>
        
  
      
    
       
        <li><p>Operations</a></li>
        
  
      
    
       
        <li><p>Configuration</a></li>
        
  
      
    
      
        <li><a href="/reference/glossary.html">Glossary</a></li>
        
  
      
    
  </ul>

      
    
  </ul>

            </aside>
    
            <article class="container__middle">
                <h1>How To Use the Python Client</h1>
                <section>
                  <h2 id="client">Client</h2>

<p>A basic usage example of the Python client is shown below. Details about PQL query syntax can be found on the <a href="/reference/pql">PQL Reference</a> page.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kn">import</span> <span class="nn">molecula</span>

    <span class="c1"># create client
</span>    <span class="n">client</span> <span class="o">=</span> <span class="n">molecula</span><span class="p">.</span><span class="n">Client</span><span class="p">(</span><span class="s">'host:port'</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">molecula</span><span class="p">.</span><span class="n">TLSAuth</span><span class="p">(</span><span class="n">certificate</span><span class="p">,</span> <span class="n">private_key</span><span class="p">))</span>

    <span class="c1"># create VDS
</span>    <span class="n">client</span><span class="p">.</span><span class="n">create_vds</span><span class="p">(</span><span class="n">vdsd</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>

    <span class="c1"># list VDSs
</span>    <span class="n">client</span><span class="p">.</span><span class="n">get_vds_list</span><span class="p">()</span>

    <span class="c1"># get VDS
</span>    <span class="n">client</span><span class="p">.</span><span class="n">get_vds</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'vds-name'</span><span class="p">)</span>

    <span class="c1"># delete VDS
</span>    <span class="n">client</span><span class="p">.</span><span class="n">delete_vds</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'vds-name'</span><span class="p">)</span>

    <span class="c1"># query a VDS (PQL)
</span>    <span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="s">"vds-name"</span><span class="p">,</span> <span class="s">"PQL query"</span><span class="p">)))</span>

    <span class="c1"># query a VDS (SQL)
</span>    <span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">querysql</span><span class="p">(</span><span class="s">"SQL query"</span><span class="p">)))</span>

    <span class="c1"># concurrent futures
</span>    <span class="n">future1</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">query_future</span><span class="p">(</span><span class="s">"vds-name"</span><span class="p">,</span> <span class="s">"PQL query"</span><span class="p">)</span>
    <span class="n">future2</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">query_future</span><span class="p">(</span><span class="s">"vds-name"</span><span class="p">,</span> <span class="s">"PQL query"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">future1</span><span class="p">.</span><span class="n">result</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="n">future2</span><span class="p">.</span><span class="n">result</span><span class="p">())</span>

    <span class="c1"># futures with SQL
</span>    <span class="n">future1</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">querysql_future</span><span class="p">(</span><span class="s">"SQL query"</span><span class="p">)</span>
    <span class="n">future2</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">querysql_future</span><span class="p">(</span><span class="s">"SQL query"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">future1</span><span class="p">.</span><span class="n">result</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="n">future2</span><span class="p">.</span><span class="n">result</span><span class="p">())</span>

    <span class="c1"># inspect record
</span>    <span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">inspect</span><span class="p">(</span><span class="s">"vds-id"</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">],</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s">"field-name"</span><span class="p">])))</span>
</code></pre></div></div>

<h3 id="connecting-to-a-cluster">Connecting to a Cluster</h3>

<p>Client-side load balancing with failover is supported via the underlying library, gRPC Core. In order to use this feature, you must configure the client address with a compatible name as defined in the <a href="https://grpc.github.io/grpc/core/md_doc_naming.html">gRPC Name Resolution</a> document. The name can resolve to multiple hosts, and those hosts will be used with a client-side Round Robin load balancer, which will automatically remove inactive hosts.</p>

<p>For example, in order to connect to two hosts named <code class="language-plaintext highlighter-rouge">10.1.100.1</code> and <code class="language-plaintext highlighter-rouge">10.1.100.2</code>, you would chose the <code class="language-plaintext highlighter-rouge">ipv4</code> scheme as defined in the gRPC Name Resolution document, and instantiate the client:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client</span> <span class="o">=</span> <span class="n">molecula</span><span class="p">.</span><span class="n">Client</span><span class="p">(</span><span class="s">'ipv4:10.1.100.1:20101,10.1.100.2:20101'</span><span class="p">)</span>
</code></pre></div></div>

<p>Similarly, you can use the above connection string with <code class="language-plaintext highlighter-rouge">pilosa-cli</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pilosa</span><span class="o">-</span><span class="n">cli</span> <span class="n">ipv4</span><span class="p">:</span><span class="mf">10.1</span><span class="p">.</span><span class="mf">100.1</span><span class="p">:</span><span class="mi">20101</span><span class="p">,</span><span class="mf">10.1</span><span class="p">.</span><span class="mf">100.2</span><span class="p">:</span><span class="mi">20101</span> <span class="n">get</span><span class="o">-</span><span class="n">vds</span><span class="o">-</span><span class="nb">list</span>
</code></pre></div></div>

                </section>
            </article>
    
            <!-- Right sidebar -->
            <nav class="container__right">
                <div>Applies to</div>

                <span>Please <a href="https://github.com/molecula/documentation/edit/gh-pages/how-tos/use-python-client.md">help improve this article</a>.</span>

                <div>
                    <span>
                        Modified: 
                    </span>
                </div>

                <div>Feedback?</div>
            </nav>
        </main>
        <footer>
            <p> &copy; 2022 Molecula Corp.</p>
        </footer>
    </div>
  </body>
</html>
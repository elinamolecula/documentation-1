<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>FeatureBase Configuration</title>
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <div class="container">
        <header>
            <a href="/"> 
                <img src="/img/logo.svg" alt="Molecula Logo" class="logo">
            </a>
        </header>
        <main class="container__main">
            <!-- Left sidebar -->
            <aside class="container__left">
                <ul>
    
      
        <li><a href="/index.html">Home</a></li>
        
  
      
    
       
        <li><p>Tutorials</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/tutorials/getting-started.html">Getting Started</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Explanation</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/explanations/architecture.html">Architecture</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>How-Tos</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/how-tos/install-featurebase.html">Install FeatureBase</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Reference</a></li>
        
  
      
        <ul>
    
       
        <li><p>Interfaces</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/reference/apis.html">APIs</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Query Languages</a></li>
        
  
      
    
       
        <li><p>Operations</a></li>
        
  
      
    
       
        <li><p>Configuration</a></li>
        
  
      
    
      
        <li><a href="/reference/glossary.html">Glossary</a></li>
        
  
      
    
  </ul>

      
    
  </ul>

            </aside>
    
            <article class="container__middle">
                <h1>FeatureBase Configuration</h1>
                <section>
                  <h3 id="configuration">Configuration</h3>

<p>FeatureBase can be configured through command line flags, environment variables, and/or a TOML configuration file; configured options take precedence in that order.</p>

<table>
  <thead>
    <tr>
      <th>CLI Flag</th>
      <th>Environment Variable</th>
      <th>Environment Variable (with <code class="language-plaintext highlighter-rouge">-future.rename</code> flag)</th>
      <th>Type</th>
      <th>Note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>advertise</td>
      <td>PILOSA_ADVERTISE</td>
      <td>FEATUREBASE_ADVERTISE</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>advertise-grpc</td>
      <td>PILOSA_ADVERTISE_GRPC</td>
      <td>FEATUREBASE_ADVERTISE_GRPC</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>bind</td>
      <td>PILOSA_BIND</td>
      <td>FEATUREBASE_BIND</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>bind-grpc</td>
      <td>PILOSA_BIND_GRPC</td>
      <td>FEATUREBASE_BIND_GRPC</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>data-dir</td>
      <td>PILOSA_DATA_DIR</td>
      <td>FEATUREBASE_DATA_DIR</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>log-path</td>
      <td>PILOSA_LOG_PATH</td>
      <td>FEATUREBASE_LOG_PATH</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>max-file-count</td>
      <td>PILOSA_MAX_FILE_COUNT</td>
      <td>FEATUREBASE_MAX_FILE_COUNT</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>max-map-count</td>
      <td>PILOSA_MAX_MAP_COUNT</td>
      <td>FEATUREBASE_MAX_MAP_COUNT</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>max-writes-per-request</td>
      <td>PILOSA_MAX_WRITES_PER_REQUEST</td>
      <td>FEATUREBASE_MAX_WRITES_PER_REQUEST</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>max-query-memory</td>
      <td>PILOSA_MAX_QUERY_MEMORY</td>
      <td>FEATUREBASE_MAX_QUERY_MEMORY</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>name</td>
      <td>PILOSA_NAME</td>
      <td>FEATUREBASE_NAME</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>verbose</td>
      <td>PILOSA_VERBOSE</td>
      <td>FEATUREBASE_VERBOSE</td>
      <td>bool</td>
      <td> </td>
    </tr>
    <tr>
      <td>usage-duty-cycle</td>
      <td>PILOSA_USAGE_DUTY_CYCLE</td>
      <td>FEATUREBASE_USAGE_DUTY_CYCLE</td>
      <td>float</td>
      <td> </td>
    </tr>
    <tr>
      <td>anti-entropy.interval</td>
      <td>PILOSA_ANTI_ENTROPY_INTERVAL</td>
      <td>FEATUREBASE_ANTI_ENTROPY_INTERVAL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>cluster.name</td>
      <td>PILOSA_CLUSTER_NAME</td>
      <td>FEATUREBASE_CLUSTER_NAME</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>cluster.long-query-time</td>
      <td>PILOSA_CLUSTER_LONG_QUERY_TIME</td>
      <td>FEATUREBASE_CLUSTER_LONG_QUERY_TIME</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>cluster.replicas</td>
      <td>PILOSA_CLUSTER_REPLICAS</td>
      <td>FEATUREBASE_CLUSTER_REPLICAS</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>etcd.advertise-client-address</td>
      <td>PILOSA_ETCD_ADVERTISE_CLIENT_ADDRESS</td>
      <td>FEATUREBASE_ETCD_ADVERTISE_CLIENT_ADDRESS</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>etcd.advertise-peer-address</td>
      <td>PILOSA_ETCD_ADVERTISE_PEER_ADDRESS</td>
      <td>FEATUREBASE_ETCD_ADVERTISE_PEER_ADDRESS</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>etcd.cluster-url</td>
      <td>PILOSA_ETCD_CLUSTER_URL</td>
      <td>FEATUREBASE_ETCD_CLUSTER_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>etcd.initial-cluster</td>
      <td>PILOSA_ETCD_INITIAL_CLUSTER</td>
      <td>FEATUREBASE_ETCD_INITIAL_CLUSTER</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>etcd.listen-client-address</td>
      <td>PILOSA_ETCD_LISTEN_CLIENT_ADDRESS</td>
      <td>FEATUREBASE_ETCD_LISTEN_CLIENT_ADDRESS</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>etcd.listen-peer-address</td>
      <td>PILOSA_ETCD_LISTEN_PEER_ADDRESS</td>
      <td>FEATUREBASE_ETCD_LISTEN_PEER_ADDRESS</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>handler.allowed-origins</td>
      <td>PILOSA_HANDLER_ALLOWED_ORIGINS</td>
      <td>FEATUREBASE_HANDLER_ALLOWED_ORIGINS</td>
      <td>list</td>
      <td> </td>
    </tr>
    <tr>
      <td>metric.diagnostics</td>
      <td>PILOSA_METRIC_DIAGNOSTICS</td>
      <td>FEATUREBASE_METRIC_DIAGNOSTICS</td>
      <td>bool</td>
      <td> </td>
    </tr>
    <tr>
      <td>metric.host</td>
      <td>PILOSA_METRIC_HOST</td>
      <td>FEATUREBASE_METRIC_HOST</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>metric.poll-interval</td>
      <td>PILOSA_METRIC_POLL_INTERVAL</td>
      <td>FEATUREBASE_METRIC_POLL_INTERVAL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>metric.service</td>
      <td>PILOSA_METRIC_SERVICE</td>
      <td>FEATUREBASE_METRIC_SERVICE</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.bind</td>
      <td>PILOSA_POSTGRES_BIND</td>
      <td>FEATUREBASE_POSTGRES_BIND</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.max-connections</td>
      <td>PILOSA_POSTGRES_MAX_CONNECTIONS</td>
      <td>FEATUREBASE_POSTGRES_MAX_CONNECTIONS</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.max-startup-size</td>
      <td>PILOSA_POSTGRES_MAX_STARTUP_SIZE</td>
      <td>FEATUREBASE_POSTGRES_MAX_STARTUP_SIZE</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.read-timeout</td>
      <td>PILOSA_POSTGRES_READ_TIMEOUT</td>
      <td>FEATUREBASE_POSTGRES_READ_TIMEOUT</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.startup-timeout</td>
      <td>PILOSA_POSTGRES_STARTUP_TIMEOUT</td>
      <td>FEATUREBASE_POSTGRES_STARTUP_TIMEOUT</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.write-timout</td>
      <td>PILOSA_POSTGRES_WRITE_TIMOUT</td>
      <td>FEATUREBASE_POSTGRES_WRITE_TIMOUT</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>postgres.tls</td>
      <td>PILOSA_POSTGRES_TLS</td>
      <td>FEATUREBASE_POSTGRES_TLS</td>
      <td>dict</td>
      <td> </td>
    </tr>
    <tr>
      <td>profile.block-rate</td>
      <td>PILOSA_PROFILE_BLOCK_RATE</td>
      <td>FEATUREBASE_PROFILE_BLOCK_RATE</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>profile.mutex-fraction</td>
      <td>PILOSA_PROFILE_MUTEX_FRACTION</td>
      <td>FEATUREBASE_PROFILE_MUTEX_FRACTION</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>schema-details-on</td>
      <td>PILOSA_SCHEMA_DETAILS_ON</td>
      <td>FEATUREBASE_SCHEMA_DETAILS_ON</td>
      <td>bool</td>
      <td> </td>
    </tr>
    <tr>
      <td>storage.backend</td>
      <td>PILOSA_STORAGE_BACKEND</td>
      <td>FEATUREBASE_STORAGE_BACKEND</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>tls.ca-certificate</td>
      <td>PILOSA_TLS_CA_CERTIFICATE</td>
      <td>FEATUREBASE_TLS_CA_CERTIFICATE</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>tls.certificate</td>
      <td>PILOSA_TLS_CERTIFICATE</td>
      <td>FEATUREBASE_TLS_CERTIFICATE</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>tls.enable-client-verification</td>
      <td>PILOSA_TLS_ENABLE_CLIENT_VERIFICATION</td>
      <td>FEATUREBASE_TLS_ENABLE_CLIENT_VERIFICATION</td>
      <td>bool</td>
      <td> </td>
    </tr>
    <tr>
      <td>tls.key</td>
      <td>PILOSA_TLS_KEY</td>
      <td>FEATUREBASE_TLS_KEY</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>tls.skip-verify</td>
      <td>PILOSA_TLS_SKIP_VERIFY</td>
      <td>FEATUREBASE_TLS_SKIP_VERIFY</td>
      <td>bool</td>
      <td> </td>
    </tr>
    <tr>
      <td>tracing.agent-host-port</td>
      <td>PILOSA_TRACING_AGENT_HOST_PORT</td>
      <td>FEATUREBASE_TRACING_AGENT_HOST_PORT</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>tracing.sampler-param</td>
      <td>PILOSA_TRACING_SAMPLER_PARAM</td>
      <td>FEATUREBASE_TRACING_SAMPLER_PARAM</td>
      <td>float</td>
      <td> </td>
    </tr>
    <tr>
      <td>tracing.sampler-type</td>
      <td>PILOSA_TRACING_SAMPLER_TYPE</td>
      <td>FEATUREBASE_TRACING_SAMPLER_TYPE</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>translation.map-size</td>
      <td>PILOSA_TRANSLATION_MAP_SIZE</td>
      <td>FEATUREBASE_TRANSLATION_MAP_SIZE</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td>translation.primary-url</td>
      <td>PILOSA_TRANSLATION_PRIMARY_URL</td>
      <td>FEATUREBASE_TRANSLATION_PRIMARY_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.enable</td>
      <td>PILOSA_AUTH_ENABLE</td>
      <td>FEATUREBASE_AUTH_ENABLE</td>
      <td>bool</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.client-id</td>
      <td>PILOSA_AUTH_CLIENT_ID</td>
      <td>FEATUREBASE_AUTH_CLIENT_ID</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.client-secret</td>
      <td>PILOSA_AUTH_CLIENT_SECRET</td>
      <td>FEATUREBASE_AUTH_CLIENT_SECRET</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.authorize-url</td>
      <td>PILOSA_AUTH_AUTHORIZE_URL</td>
      <td>FEATUREBASE_AUTH_AUTHORIZE_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.token-url</td>
      <td>PILOSA_AUTH_TOKEN_URL</td>
      <td>FEATUREBASE_AUTH_TOKEN_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.group-endpoint-url</td>
      <td>PILOSA_AUTH_GROUP_ENDPOINT_URL</td>
      <td>FEATUREBASE_AUTH_GROUP_ENDPOINT_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.redirect-base-url</td>
      <td>PILOSA_AUTH_REDIRECT_BASE_URL</td>
      <td>FEATUREBASE_AUTH_REDIRECT_BASE_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.logout-url</td>
      <td>PILOSA_AUTH_LOGOUT_URL</td>
      <td>FEATUREBASE_AUTH_LOGOUT_URL</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.scopes</td>
      <td>PILOSA_AUTH_SCOPES</td>
      <td>FEATUREBASE_AUTH_SCOPES</td>
      <td>list</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.secret-key</td>
      <td>PILOSA_AUTH_SECRET_KEY</td>
      <td>FEATUREBASE_AUTH_SECRET_KEY</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.permissions</td>
      <td>PILOSA_AUTH_PERMISSIONS</td>
      <td>FEATUREBASE_AUTH_PERMISSIONS</td>
      <td>str</td>
      <td> </td>
    </tr>
    <tr>
      <td>auth.query-log-path</td>
      <td>PILOSA_AUTH_QUERY_LOG_PATH</td>
      <td>FEATUREBASE_AUTH_QUERY_LOG_PATH</td>
      <td>str</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Options are listed in the table by their CLI and Environment names. Further details are given below with the TOML configuration file variables. Note that there is a direct correlation between the CLI name and the TOML name. For example, the CLI flag <code class="language-plaintext highlighter-rouge">etcd.initial-cluster</code> is identified in TOML as:</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[etcd]</span>
  <span class="py">initial-cluster</span> <span class="p">=</span> <span class="s">"featurebase1=http://localhost:10301,featurebase2=http://localhost:10302"</span>
</code></pre></div></div>

<h4 id="advertise">Advertise</h4>

<p>Address advertised by the server to other nodes in the cluster and to clients via the <code class="language-plaintext highlighter-rouge">/status</code> endpoint. Host defaults to the IP address represented by <code class="language-plaintext highlighter-rouge">bind</code> and port to 10101. If <code class="language-plaintext highlighter-rouge">bind</code> is set to <code class="language-plaintext highlighter-rouge">0.0.0.0</code> and <code class="language-plaintext highlighter-rouge">advertise</code> is not specified, then FeatureBase will try to determine a reasonable, external IP address to use for <code class="language-plaintext highlighter-rouge">advertise</code>.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">advertise</span> <span class="p">=</span> <span class="mf">192.168.1.100</span><span class="err">:</span><span class="mi">10101</span>
</code></pre></div></div>

<h4 id="anti-entropy-interval">Anti Entropy Interval</h4>

<p>Interval at which the cluster will run its anti-entropy routine which ensures that all replicas of each shard are in sync.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[anti-entropy]</span>
      <span class="py">interval</span> <span class="p">=</span> <span class="s">"10m0s"</span>
</code></pre></div></div>

<h4 id="bind">Bind</h4>

<p>host:port on which the FeatureBase server will listen for requests. Host defaults to localhost and port to 10101. If <code class="language-plaintext highlighter-rouge">bind</code> is set to <code class="language-plaintext highlighter-rouge">0.0.0.0</code> then FeatureBase will listen on all available interfaces.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">bind</span> <span class="p">=</span> <span class="err">localhost:</span><span class="mi">10101</span>
</code></pre></div></div>

<h4 id="cors-cross-origin-resource-sharing-allowed-origins">CORS (Cross-Origin Resource Sharing) Allowed Origins</h4>

<p>List of allowed origin URIs for CORS</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[handler]</span>
      <span class="py">allowed-origins</span> <span class="p">=</span> <span class="p">[</span><span class="s">"https://myapp.com"</span><span class="p">,</span> <span class="s">"https://myapp.org"</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="data-dir">Data Dir</h4>

<p>Directory to store FeatureBase data files.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">data-dir</span> <span class="p">=</span> <span class="s">"/opt/molecula/featurebase"</span>
</code></pre></div></div>

<h4 id="log-path">Log Path</h4>

<p>Path of log file.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">log-path</span> <span class="p">=</span> <span class="s">"/path/to/logfile"</span>
</code></pre></div></div>

<h4 id="name">Name</h4>

<p>Unique name for the node in the cluster.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">name</span> <span class="p">=</span> <span class="s">"featurebase0"</span>
</code></pre></div></div>

<h4 id="verbose">Verbose</h4>

<p>Enable verbose logging.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">verbose</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div></div>

<h4 id="max-map-count">Max Map Count</h4>

<p>Maximum number of active memory maps FeatureBase will use for fragment files (actual total usage may be slightly higher). Best practice is to set this ~10% lower than your system’s maximum map count (obtained via <code class="language-plaintext highlighter-rouge">sysctl vm.max_map_count</code> on Linux). If you plan on having lots of fragments per host, it’s a good idea to raise both the system’s max map count, and FeatureBase’s. The number of fragments is a function of the number of shards, fields, and time quantums. Using, for example, YMDH time quantum fields with a wide range of timestamps will create lots of fragments. When FeatureBase exhausts the max-map-count it falls back to reading files directly into memory. This can be a bit slower, and cause slower restarts, but is generally fine.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">max-map-count</span> <span class="p">=</span> <span class="mi">1000000</span>
</code></pre></div></div>

<h4 id="max-writes-per-request">Max Writes Per Request</h4>

<p>Maximum number of mutating commands allowed per request. This includes Set, Clear, ClearRow, and Store.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">max-writes-per-request</span> <span class="p">=</span> <span class="mi">5000</span>
</code></pre></div></div>

<h4 id="max-file-count">Max File Count</h4>

<p>A soft limit on the maximum number of files that FeatureBase will keep open simultaneously. When past this limit, FeatureBase will only keep files open for as long as it needs to write updates. This will negatively affect performance in cases where FeatureBase is doing lots of small updates.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">max-file-count</span> <span class="p">=</span> <span class="mi">1000000</span>
</code></pre></div></div>
<h4 id="max-query-memory">Max Query Memory</h4>
<p>A limit on the maximum memory allowed per Extract() or SELECT query. When past this limit, FeatureBase will return an error <code class="language-plaintext highlighter-rouge">"query result exceeded memory threshold"</code>. When limit is not set, the max query memory is set to 20% of total memory of the node by default. The max query memory is specified in bytes.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="py">max-query-memory</span> <span class="p">=</span> <span class="mi">4000000000</span>
</code></pre></div></div>

<h4 id="cluster-name">Cluster Name</h4>

<p>Name for the cluster, must be the same on all nodes in the cluster.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[cluster]</span>
      <span class="py">name</span> <span class="p">=</span> <span class="s">"cluster0"</span>
</code></pre></div></div>

<h4 id="cluster-replicas">Cluster Replicas</h4>

<p>Number of hosts each piece of data should be stored on. Must be greater than or equal to 1 and less than or equal to the number of nodes in the cluster.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[cluster]</span>
      <span class="py">replicas</span> <span class="p">=</span> <span class="mi">1</span>
</code></pre></div></div>

<h4 id="etcd-advertise-client-address">Etcd Advertise Client Address</h4>

<p>Address to advertise externally for client connections. If a value is not provided, this will default to the value provided for <code class="language-plaintext highlighter-rouge">etcd.listen-client-address</code>.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[etcd]</span>
      <span class="py">advertise-client-address</span> <span class="p">=</span> <span class="s">"http://localhost:10401"</span>
</code></pre></div></div>

<h4 id="etcd-advertise-peer-address">Etcd Advertise Peer Address</h4>

<p>Address to advertise externally for peer connections. If a value is not provided, this will default to the value provided for <code class="language-plaintext highlighter-rouge">etcd.listen-peer-address</code>.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[etcd]</span>
      <span class="py">advertise-peer-address</span> <span class="p">=</span> <span class="s">"http://localhost:10301"</span>
</code></pre></div></div>

<h4 id="etcd-cluster-url">Etcd Cluster URL</h4>

<p>URL of an existing cluster that a new node should join to when growing the cluster.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[etcd]</span>
      <span class="py">cluster-url</span> <span class="p">=</span> <span class="s">"http://localhost:10401"</span>
</code></pre></div></div>

<h4 id="etcd-initial-cluster">Etcd Initial Cluster</h4>

<p>Comma-separated list of <code class="language-plaintext highlighter-rouge">node=address</code> pairs which make up the initial cluster when it’s first started. In each pair, the <code class="language-plaintext highlighter-rouge">node</code> value—the left side of the <code class="language-plaintext highlighter-rouge">=</code> sign—should match the name of the node which is specified by its <code class="language-plaintext highlighter-rouge">name</code> configuration parameter.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[etcd]</span>
      <span class="py">initial-cluster</span> <span class="p">=</span> <span class="s">"featurebase1=http://localhost:10401,featurebase2=http://localhost:10402"</span>
</code></pre></div></div>

<h4 id="etcd-listen-client-address">Etcd Listen Client Address</h4>

<p>Address and port to bind to for client communication.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[etcd]</span>
      <span class="py">listen-client-address</span> <span class="p">=</span> <span class="s">"http://localhost:10401"</span>
</code></pre></div></div>

<h4 id="etcd-listen-peer-address">Etcd Listen Peer Address</h4>

<p>Address and port to bind to for peer communication.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[etcd]</span>
      <span class="py">listen-peer-address</span> <span class="p">=</span> <span class="s">"http://localhost:10301"</span>
</code></pre></div></div>

<h4 id="profile-cpu">Profile CPU</h4>

<p>If this is set to a path, collect a cpu profile and store it there.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[profile]</span>
      <span class="py">cpu</span> <span class="p">=</span> <span class="s">"/path/to/somewhere"</span>
</code></pre></div></div>

<h4 id="profile-cpu-time">Profile CPU Time</h4>

<p>Amount of time to collect cpu profiling data at startup if <code class="language-plaintext highlighter-rouge">profile.cpu</code> is set.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[profile]</span>
      <span class="py">cpu-time</span> <span class="p">=</span> <span class="s">"30s"</span>
</code></pre></div></div>

<h4 id="metric-service">Metric Service</h4>

<p>Which stats service to use for collecting metrics. Choose from [statsd, expvar, prometheus, none].</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[metric]</span>
      <span class="py">service</span> <span class="p">=</span> <span class="s">"statsd"</span>
</code></pre></div></div>

<h4 id="metric-host">Metric Host</h4>

<p>Address of the StatsD service host.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[metric]</span>
      <span class="py">host</span> <span class="p">=</span> <span class="s">"localhost:8125"</span>
</code></pre></div></div>

<h4 id="metric-poll-interval">Metric Poll Interval</h4>

<p>Rate at which runtime metrics (such as open file handles and memory usage) are collected.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[metric]</span>
      <span class="py">poll-interval</span> <span class="p">=</span> <span class="s">"0m15s"</span>
</code></pre></div></div>

<h4 id="metric-diagnostics">Metric Diagnostics</h4>

<p>Enable reporting of limited usage statistics to FeatureBase developers. To disable, set to false.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[metric]</span>
      <span class="py">diagnostics</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div></div>

<h4 id="storage-backend">Storage Backend</h4>

<p>Storage backend to use for all indexes in the cluster. Options are: “rbf”, “roaring”, “bolt”. “bolt” is used for testing, and “roaring” is deprecated. Don’t change this unless you know what you’re doing. Default: “rbf”.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[storage]</span>
      <span class="py">backend</span> <span class="p">=</span> <span class="s">"rbf"</span>
</code></pre></div></div>

<h4 id="tls-certificate">TLS Certificate</h4>

<p>Path to the TLS certificate to use for serving HTTPS. Usually has one of <code class="language-plaintext highlighter-rouge">.crt</code> or <code class="language-plaintext highlighter-rouge">.pem</code> extensions.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[tls]</span>
      <span class="py">certificate</span> <span class="p">=</span> <span class="s">"/srv/featurebase/certs/server.crt"</span>
</code></pre></div></div>

<h4 id="tls-certificate-key">TLS Certificate Key</h4>

<p>Path to the TLS certificate key to use for serving HTTPS. Usually has the <code class="language-plaintext highlighter-rouge">.key</code> extension.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[tls]</span>
      <span class="py">key</span> <span class="p">=</span> <span class="s">"/srv/featurebase/certs/server.key"</span>
</code></pre></div></div>

<h4 id="tls-skip-verify">TLS Skip Verify</h4>

<p>Disables verification for checking TLS certificates. This configuration item is mainly useful for using self-signed certificates for a FeatureBase cluster. Do not use in production since it makes man-in-the-middle attacks trivial.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[tls]</span>
      <span class="py">skip-verify</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div></div>

<h4 id="tracing-sampler-type">Tracing Sampler Type</h4>

<p>Jaeger sampler type (const, probabilistic, ratelimiting, or remote). Set to ‘<code class="language-plaintext highlighter-rouge">off</code>’ to disable tracing completely.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[tracing]</span>
      <span class="py">sampler-type</span> <span class="p">=</span> <span class="s">"remote"</span>
</code></pre></div></div>

<h4 id="tracing-sampler-parameter">Tracing Sampler Parameter</h4>

<p>Jaeger sampler parameter (number)</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[tracing]</span>
      <span class="py">sampler-param</span> <span class="p">=</span> <span class="mf">0.001</span>
</code></pre></div></div>

<h4 id="tracing-agent-hostport">Tracing Agent Host/Port</h4>

<p>Jaeger agent host:port</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[tracing]</span>
      <span class="py">agent-host-port</span> <span class="p">=</span> <span class="s">"localhost:6831"</span>
</code></pre></div></div>

<h4 id="profile-block-rate">Profile Block Rate</h4>

<p>Block Rate is passed directly to Go’s runtime.SetBlockProfileRate. Goroutine blocking events will be sampled at 1 per <code class="language-plaintext highlighter-rouge">rate</code> nanoseconds. A value of “1” samples every event, and 0 disables profiling.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[profile]</span>
      <span class="py">block-rate</span> <span class="p">=</span> <span class="mi">10000000</span>
</code></pre></div></div>

<h4 id="profile-mutex-fraction">Profile Mutex Fraction</h4>

<p>Mutex Fraction is passed directly to Go’s runtime.SetMutexProfileFraction. 1/<code class="language-plaintext highlighter-rouge">fraction</code> of events will be sampled.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[profile]</span>
      <span class="py">mutex-fraction</span> <span class="p">=</span> <span class="mi">100</span>
</code></pre></div></div>

<h4 id="translation-map-size">Translation Map Size</h4>

<p>Size in bytes of mmap to allocate for key translation</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[translation]</span>
      <span class="py">map-size</span> <span class="p">=</span> <span class="mi">10737418240</span>
</code></pre></div></div>

<h4 id="postgres-endpoint-bind">Postgres Endpoint Bind</h4>

<p>Address to bind a postgres wire protocol endpoint.
No postgres endpoint will be exposed unless a bind address is specified.
Requires Molecula v3.0 or newer.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[postgres]</span>
      <span class="py">bind</span> <span class="p">=</span> <span class="s">"localhost:55432"</span>
</code></pre></div></div>

<h4 id="postgres-endpoint-tls">Postgres Endpoint TLS</h4>

<p>The TLS configuration for the postgres endpoint is structured the same as the TLS configuration for FeatureBase’s other endpoints, but placed under <code class="language-plaintext highlighter-rouge">[postgres.tls]</code>.
If TLS is configured on the postgres endpoint, FeatureBase will reject unsecured connections.</p>

<p>Example configuration with mutual TLS:</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[postgres]</span>
      <span class="py">bind</span> <span class="p">=</span> <span class="s">"localhost:55432"</span>
      <span class="nn">[postgres.tls]</span>
        <span class="py">certificate</span> <span class="p">=</span> <span class="s">"/srv/featurebase/certs/server.crt"</span>
        <span class="py">key</span> <span class="p">=</span> <span class="s">"/srv/featurebase/certs/server.key"</span>
        <span class="py">ca-certificate</span> <span class="p">=</span> <span class="s">"/srv/featurebase/certs/ca.crt"</span>
        <span class="py">enable-client-verification</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div></div>

<h4 id="postgres-endpoint-connection-limit">Postgres Endpoint Connection Limit</h4>

<p>The postgres endpoint has support for a connection limit.
This is generally not necessary, so it is disabled by default.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[postgres]</span>
      <span class="py">connection-limit</span> <span class="p">=</span> <span class="mi">10000</span>
</code></pre></div></div>

<h4 id="postgres-maximum-startup-packet-size">Postgres Maximum Startup Packet Size</h4>

<p>By default, the postgres endpoint uses an 8 MiB limit on incoming postgres startup packets.
This should typically be sufficient, but may be exceeded if a client sends an unusually large amount of configuration data.
Oversized startup packets are typically caused by connecting with a different protocol (e.g. HTTP).</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[postgres]</span>
      <span class="py">max-startup-size</span> <span class="p">=</span> <span class="mi">10000000</span>
</code></pre></div></div>

<h4 id="postgres-timeouts">Postgres Timeouts</h4>

<p>In order to detect stalled clients, the Postgres endpoint has connection read and write timeouts.
There is also a startup timeout, which is used for connection setup.</p>

<p>The read timeout does not impact idle connections.
Idle connections will only be closed by the server if TCP keepalive reports a break in the connection.
TCP keepalives use the default configuration provided by the host.</p>

<p>:::caution
Due to a limitation of the postgres wire protocol, raising the write timeout may delay the shutdown of a FeatureBase node.
:::</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nn">[postgres]</span>
      <span class="py">startup-timeout</span> <span class="p">=</span> <span class="s">"20s"</span>
      <span class="py">read-timeout</span> <span class="p">=</span> <span class="s">"20s"</span>
      <span class="py">write-timeout</span> <span class="p">=</span> <span class="s">"20s"</span>
</code></pre></div></div>

<h4 id="usage-duty-cycle">Usage Duty Cycle</h4>

<p>FeatureBase maintains a disk/memory usage cache that is calculated periodically in the background and accessed by the ui/usage endpoint. Because this disk scan can take a long, and unpredictable, amount of time, its timing behavior is specified in a relative, rather than absolute, sense. That is, the duty cycle sets the percentage of time that is spent recalculating this cache. 
Special considerations:</p>
<ul>
  <li>If disk usage can be calculated quickly (less than 5 seconds), fresh results will be calculated when accessed.</li>
  <li>When disk usage takes longer to calculate, there is a minimum of one hour wait between cache recalculations.</li>
</ul>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="py">usage-duty-cycle</span> <span class="p">=</span> <span class="mi">20</span>
</code></pre></div></div>
<h4 id="schema-details-endpoint-toggle">Schema Details Endpoint Toggle</h4>

<p>The /schema/details endpoint is used by the UI to populate the “Tables” page. It is can be a time intensive calculation on certain datasets since it calculates the cardinality for every field in every index. Queries that are running while this is calculation is happening can be slow. If cardinality information is not needed, this feature can be turned off, in which case /schema/details will behave like the general /schema endpoint.</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="py">schema-details-on</span><span class="p">=</span><span class="kc">false</span>
</code></pre></div></div>

<h4 id="auth-authenticationauthorization-configuration">Auth (Authentication/Authorization) configuration</h4>
<p>Parameters to configure FeatureBase authentication and authorization with an identity provider.</p>
<h4 id="parameters">Parameters</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">enable</code>: enable/disable auth in FeatureBase.</li>
  <li><code class="language-plaintext highlighter-rouge">secret-key</code>: Use <code class="language-plaintext highlighter-rouge">keygen</code> included in FeatureBase release to generate a secret key. This key is used for securing intra-node communication in a FeatureBase cluster.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>featurebase keygen
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">permissions</code>: path to <code class="language-plaintext highlighter-rouge">permissions.yaml</code> file which maps group IDs from identity provider to permissions for indexes in FeatureBase.</li>
</ul>

<p>Identity provider specific parameters should be obtained from the identity provider.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">client-id</code>: client id for registered application.</li>
  <li><code class="language-plaintext highlighter-rouge">client-secret</code>: client secret for registered application.</li>
  <li><code class="language-plaintext highlighter-rouge">authorize-url</code>: authorization endpoint on the identity provider’s domain.</li>
  <li><code class="language-plaintext highlighter-rouge">token-url</code>: token endpoint to obtain JWT from identity provider.</li>
  <li><code class="language-plaintext highlighter-rouge">redirect-base-url</code>: redirect url configured in identity provider without <code class="language-plaintext highlighter-rouge">/redirect</code>. This is usually the URI of your primary featurebase node, e.g. “https://your-ip-here:10101”</li>
  <li><code class="language-plaintext highlighter-rouge">group-endpoint-url</code>: HTTP endpoint that returns groups for a user’s valid JWT</li>
  <li><code class="language-plaintext highlighter-rouge">logout-url</code>: identity provider’s logout URL</li>
  <li><code class="language-plaintext highlighter-rouge">scopes</code>: a list of scopes required for an access token to request groups from the identity provider.</li>
</ul>


                </section>
            </article>
    
            <!-- Right sidebar -->
            <nav class="container__right">
                <div>Applies to</div>

                <span>Please <a href="https://github.com/molecula/documentation/edit/gh-pages/reference/featurebase-configuration.md">help improve this article</a>.</span>

                <div>
                    <span>
                        Modified: 
                    </span>
                </div>

                <div>Feedback?</div>
            </nav>
        </main>
        <footer>
            <p> &copy; 2022 Molecula Corp.</p>
        </footer>
    </div>
  </body>
</html>
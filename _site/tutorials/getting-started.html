<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Getting Started With Molecula</title>
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <div class="container">
        <header>
            <a href="/"> 
                <img src="/img/logo.svg" alt="Molecula Logo" class="logo">
            </a>
        </header>
        <main class="container__main">
            <!-- Left sidebar -->
            <aside class="container__left">
                <ul>
    
      
        <li><a href="/index.html">Home</a></li>
        
  
      
    
       
        <li><p>Tutorials</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/tutorials/getting-started.html">Getting Started</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Explanation</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/explanations/architecture.html">Architecture</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>How-Tos</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/how-tos/install-featurebase.html">Install FeatureBase</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Reference</a></li>
        
  
      
        <ul>
    
       
        <li><p>Interfaces</a></li>
        
  
      
        <ul>
    
      
        <li><a href="/reference/apis.html">APIs</a></li>
        
  
      
    
  </ul>

      
    
       
        <li><p>Query Languages</a></li>
        
  
      
    
       
        <li><p>Operations</a></li>
        
  
      
    
       
        <li><p>Configuration</a></li>
        
  
      
    
      
        <li><a href="/reference/glossary.html">Glossary</a></li>
        
  
      
    
  </ul>

      
    
  </ul>

            </aside>
    
            <article class="container__middle">
                <h1>Getting Started With Molecula</h1>
                <section>
                  <p>FeatureBase supports multiple interfaces for querying and <a href="/explanations/ingesters">ingestion</a>. For this tutorial, we shall use the <code class="language-plaintext highlighter-rouge">csv-ingester</code> to insert data and both the web-UI and Postgres interface (via psql) to get familiar with querying FeatureBase. Ultimately you’ll probably want to interact with Molecula through a <a href="/how-tos/use-python-client">client library</a>.</p>

<p>:::note
Note that FeatureBase server requires a high limit for open files. Check the documentation of your system to see how to increase it in case you hit that limit. As a workaround, you can also cap FeatureBase’s <a href="/reference/featurebase-configuration#max-file-count">max-file-count</a>.
:::</p>

<h3 id="starting-featurebase">Starting FeatureBase</h3>

<p>Grab the appropriate FeatureBase binary for your system from the release you were provided, or from https://releases.molecula.cloud/.</p>

<p>The FeatureBase binary can be run directly, with no setup and minimal configuration. For a production installation, some additional setup may be appropriate; see the <a href="/how-tos/install-featurebase">installation guide</a>.</p>

<p>:::note
FeatureBase runs well on Linux and MacOS. It will not run on Windows.
:::</p>

<p>You can place it somewhere on your <code class="language-plaintext highlighter-rouge">PATH</code>, or run the binary directly.</p>

<p>Execute the following in a terminal to run FeatureBase with the default configuration (FeatureBase will be available at <a href="http://localhost:10101">localhost:10101</a>). The <code class="language-plaintext highlighter-rouge">--handler.allowed-origins</code> argument enables you to query FeatureBase from the <a href="/reference/web-ui">web-UI</a> via the given port and address. The <code class="language-plaintext highlighter-rouge">--postgres.bind</code> argument enables you to query FeatureBase from its Postgres-wire compatible endpoint, also via the given address and port.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>featurebase server <span class="se">\</span>
  <span class="nt">--handler</span>.allowed-origins http://localhost:3000 <span class="se">\</span>
  <span class="nt">--postgres</span>.bind <span class="s2">"localhost:55432"</span>
</code></pre></div></div>

<p>From there, start the <a href="/reference/web-ui">web UI</a>. It will indicate whether FeatureBase is running successfuly on the homepage.<br />
If you prefer using the CLI, you can connect to and query FeatureBase using <code class="language-plaintext highlighter-rouge">psql</code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psql <span class="nt">-h</span> localhost <span class="nt">-p</span> 55432
</code></pre></div></div>

<p>You can also use <code class="language-plaintext highlighter-rouge">curl</code> to check several HTTP endpoints that provide additional information, including <code class="language-plaintext highlighter-rouge">/status</code>, <code class="language-plaintext highlighter-rouge">/info</code>, and <code class="language-plaintext highlighter-rouge">/schema</code>. For example:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl localhost:10101/status
</code></pre></div></div>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NORMAL"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"nodes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"32ce5e768b0d8ca5"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"scheme"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">10101</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"grpc-uri"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"scheme"</span><span class="p">:</span><span class="w"> </span><span class="s2">"grpc"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">20101</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"isPrimary"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STARTED"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"localID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"32ce5e768b0d8ca5"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clusterName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cluster0"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="sample-project">Sample Project</h3>

<p>In order to better understand FeatureBase’s capabilities, we will create a sample project called “Star Trace” containing information about 1,000 popular Github repositories which have “go” in their name. The Star Trace index will include data points such as programming language and stargazers—people who have starred a project.</p>

<p>Although FeatureBase doesn’t keep the data in a tabular format, we still use the terms “columns” and “rows” when describing the data model. We put the primary objects in columns, and the properties of those objects in rows. For example, the Star Trace project will contain an index called “repository” which contains columns representing Github repositories, and rows representing properties like programming languages and stargazers. We can better organize the rows by grouping them into sets called Fields. So the “repository” index might have a “languages” field as well as a “stargazers” field. You can learn more about indexes and fields in the <a href="../data-model/">Data Model</a> section of the documentation.</p>

<p>:::note
If at any time you want to verify the data structure, you can request the schema as follows:
:::</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl localhost:10101/schema
</code></pre></div></div>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"indexes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"repository"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"keys"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"trackExistence"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"language"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"set"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cacheType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ranked"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cacheSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">50000</span><span class="p">,</span><span class="w">
            </span><span class="nl">"keys"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stargazer"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"time"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"timeQuantum"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YMD"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"keys"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"noStandardView"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"shardWidth"</span><span class="p">:</span><span class="w"> </span><span class="mi">1048576</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>:::note
This is the response you should receive once completing this project. It has also been formatted using <a href="https://stedolan.github.io/jq/&quot;"><code class="language-plaintext highlighter-rouge">jq</code></a>.
:::</p>

<h3 id="ingesting-the-data">Ingesting the data</h3>

<p>To reiterate, each Project has a set of languages used and a set of users who starred the project. Additionally, we will also be tracking the time at which users starred a given project using time-quantums. As far as github projects go, the languages used within the project evolve separately from when users star a project. To simulate this, we’ll ingest the languages used separately from the stargazers.</p>

<p>First, download the <code class="language-plaintext highlighter-rouge">stargazer.csv</code> and <code class="language-plaintext highlighter-rouge">language.csv</code> files using these commands:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-O</span> https://raw.githubusercontent.com/pilosa/getting-started/master/stargazer.csv
curl <span class="nt">-O</span> https://raw.githubusercontent.com/pilosa/getting-started/master/language.csv
</code></pre></div></div>

<p>Note that both the user IDs and the repository IDs were remapped from Github entities to sequential integers in the data files. You can check out <a href="https://github.com/pilosa/getting-started/blob/master/languages.txt">languages.txt</a> to see the mapping for languages.</p>

<h3 id="ingest-data">Ingest Data</h3>
<p>Ingest the language data using the <code class="language-plaintext highlighter-rouge">molecula-consumer-csv</code> command:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>molecula-consumer-csv <span class="se">\</span>
    <span class="nt">--index</span> repository <span class="se">\</span>
    <span class="nt">--header</span> <span class="s2">"language__ID_F,project_id__ID_F"</span> <span class="se">\</span>
    <span class="nt">--id-field</span> project_id <span class="se">\</span>
    <span class="nt">--batch-size</span> 1000 <span class="se">\</span>
    <span class="nt">--files</span> language.csv 

</code></pre></div></div>

<p>There are a couple of things to note about the above command, particularly the flags and arguments used:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">--index</code>: set the index that shall be used. If this index does not exist, it shall be created automatically.</li>
  <li><code class="language-plaintext highlighter-rouge">--header</code>: set the header to be used if the original csv file does not have a header. Each column name also specifies the type that FeatureBase shall use to represent the data (after the two underscores). For more details on all the data-types that Molecula avails, be sure to check out the <a href="reference/ingester-configuration">Field Types</a> section later on. For now, it suffices to say that the <code class="language-plaintext highlighter-rouge">ID</code> type is a simple integer representation of a particular property that an object has. For example, if an object has <code class="language-plaintext highlighter-rouge">project_id</code> set to 10 and <code class="language-plaintext highlighter-rouge">language</code> set to 6, 8 and 18, it means that the object was assigned the project ID 10 and uses Go, C and Python.</li>
  <li><code class="language-plaintext highlighter-rouge">--id-field</code>: specify which column contains the primary key for the object.</li>
  <li><code class="language-plaintext highlighter-rouge">--batch-size</code>: by default <code class="language-plaintext highlighter-rouge">molecula-consumer-csv</code> ingests rows one at a time which is quite slow. To speed up ingestion, set the batch size to a higher number such as 1000. The exact batch-size to be used though depends on the domain, setting and tradeoffs.</li>
  <li><code class="language-plaintext highlighter-rouge">--files</code>: provide the path to the file to ingest data from.</li>
</ul>

<p>Next,ingest the stargazers via the following command:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>molecula-consumer-csv <span class="se">\</span>
    <span class="nt">--index</span> repository <span class="se">\</span>
    <span class="nt">--header</span> <span class="s2">"stargazer__ID_F_YMD,project_id__ID_F,date__RecordTime_2006-01-02T15:04"</span> <span class="se">\</span>
    <span class="nt">--id-field</span> <span class="s1">'project_id'</span> <span class="se">\</span>
    <span class="nt">--batch-size</span> 50000 <span class="se">\</span>
    <span class="nt">--files</span> stargazer.csv
</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">--batch-size</code> is set to a larger value this time. Furthermore, as mentioned earlier, we are tracking not just which user starred a project, but also when they did it, with a time field. The last argument for the <code class="language-plaintext highlighter-rouge">stargazer</code> field, with the value of <code class="language-plaintext highlighter-rouge">YMD</code>, sets the field’s <a href="/reference/glossary#time-quantum">time quantum</a> (granularity) to year, month, day.</p>

<h3 id="querying-the-data">Querying the data</h3>
<p>With the index populated, queries can now be used to explore the data. These can be executed via either psql or the web UI.</p>

<p>Which repositories did user 14 star:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>repository]Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>14<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<pre><code class="language-table"> _id 
═════
 1
 2
 3
 362
 368
 391
 ... // truncated
 (27 rows)
</code></pre>

<p>What are the top 5 languages in the sample data:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>repository]TopN<span class="o">(</span>language, <span class="nv">n</span><span class="o">=</span>5<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<pre><code class="language-table">+-----------+--------+
|  language | count  |
+-----------+--------+
|         5 |    119 |
|         1 |     50 |
|         4 |     48 |
|         9 |     31 |
|        13 |     25 |
+-----------+--------+
(5 rows)
</code></pre>

<p>Which repositories were starred by user 14 and 19:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>repository]Intersect<span class="o">(</span>
    Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>14<span class="o">)</span>, 
    Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>19<span class="o">)</span>
<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<pre><code class="language-table"> _id 
═════
 2
 3
 362
 396
 416
 461
 464
 466
 470
 486
(10 rows)
</code></pre>

<p>Which repositories were starred by user 14 or 19:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>repository]Union<span class="o">(</span>
    Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>14<span class="o">)</span>, 
    Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>19<span class="o">)</span>
<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<pre><code class="language-table"> _id 
═════
 1
 2
 3
 361
 362
 368
 376
 377
 378
... // truncated
(50 rows)
</code></pre>

<p>Which repositories were starred by user 14 and 19 and also were written in language 1:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>repository]Intersect<span class="o">(</span>
    Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>14<span class="o">)</span>, 
    Row<span class="o">(</span><span class="nv">stargazer</span><span class="o">=</span>19<span class="o">)</span>,
    Row<span class="o">(</span><span class="nv">language</span><span class="o">=</span>1<span class="o">)</span>
<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<pre><code class="language-table"> _id 
═════
 2
 362
 416
 461
(4 rows)
</code></pre>

<p>Set user 99999 as a stargazer for repository 77777:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>repository]Set<span class="o">(</span>77777, <span class="nv">stargazer</span><span class="o">=</span>99999<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<pre><code class="language-table"> result 
════════
 true
(1 row)
</code></pre>

<p>Please note that while user ID 99999 may not be sequential with the other column IDs, it is still a relatively low number. 
Don’t try to use arbitrary 64-bit integers as column or row IDs in FeatureBase - this will lead to problems such as poor performance and out of memory errors.</p>

                </section>
            </article>
    
            <!-- Right sidebar -->
            <nav class="container__right">
                <div>Applies to</div>

                <span>Please <a href="https://github.com/molecula/documentation/edit/gh-pages/tutorials/getting-started.md">help improve this article</a>.</span>

                <div>
                    <span>
                        Modified: 
                    </span>
                </div>

                <div>Feedback?</div>
            </nav>
        </main>
        <footer>
            <p> &copy; 2022 Molecula Corp.</p>
        </footer>
    </div>
  </body>
</html>